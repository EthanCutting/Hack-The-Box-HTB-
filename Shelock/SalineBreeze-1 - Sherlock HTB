------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# SalineBreeze-1 - Sherlock HTB
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 1 - Starting with the MITRE ATT&CK page, which country is thought be behind Salt Typhoon?

üá®üá≥ China (People‚Äôs Republic of China)
MITRE assesses Salt Typhoon as a China-nexus, state-sponsored threat actor, based on its targeting, tradecraft, and overlap with other PRC-linked espionage operations.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 2 - According to that page, Salt Typhoon has been active since at least when? (Year)

According to the MITRE ATT&CK page for Salt Typhoon (G1045), the group has been active since at least 2019.
What ‚Äúsince at least 2019‚Äù means (and why MITRE phrases it this way)
    - Earliest confirmed activity: 2019 is the earliest year with reliable, publicly reported evidence that analysts can confidently attribute to this group.
    - Not necessarily the beginning: Nation-state groups often operate years before they‚Äôre discovered. The wording ‚Äúsince at least‚Äù acknowledges that Salt Typhoon may have been active earlier, but 2019 is the first point with solid attribution.
    - Long-term espionage: Activity spanning multiple years is typical of state-linked threat actors, especially those focused on telecommunications and network infrastructure, where persistence and stealth matter more than quick impact.
    - Consistent tradecraft over time: Since 2019, reporting shows recurring patterns‚Äîuse of valid credentials, network device configuration dumping, traffic capture, tunneling, and log clearing‚Äîindicating a mature, well-resourced operation rather than an ad-hoc campaign.
    - In short, 2019 marks the beginning of Salt Typhoon‚Äôs known and documented operations, highlighting that this is a long-running espionage actor, not a recent or opportunistic threat.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 3 - What kind of infrastructure does Salt Typhoon target?

Salt Typhoon primarily targets network infrastructure, especially:
üõ∞Ô∏è Telecommunications & ISP infrastructure
This includes:
    - Core and edge routers
    - Switches
    - Network management systems (NMS)
    - Devices used by telecommunications companies and internet service providers (ISPs)
Rather than focusing on individual laptops or servers, Salt Typhoon goes after the plumbing of the internet.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 4 - Salt Typhoon has been associated with multiple custom built malware, what is the name of the malware associated with the ID S1206?

JumbledPath is a custom-built malware linked to Salt Typhoon, used primarily against network infrastructure devices. It has been observed acting as a network sniffer and supporting long-term espionage operations, which aligns with Salt Typhoon‚Äôs focus on telecommunications environments.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 5 - What operating system does this malware target?

More specifically:
    - It runs on Linux, including embedded Linux used by network infrastructure devices (such as routers and switches in telecom/ISP environments).
    - It is compiled as an ELF binary, which is standard for Linux systems.
    - This fits Salt Typhoon‚Äôs focus on network infrastructure, since many enterprise and telecom network devices run customized versions of Linux rather than Windows.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 6 - What programming language is the malware written in?

    Go (Golang)
Go is commonly used in modern malware because it allows easy cross-platform compilation, produces statically linked binaries, and runs well on Linux-based systems ‚Äî making it well suited for targeting network infrastructure.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 7 - On which vendor's devices does the malware act as a network sniffer?

JumbledPath has been observed running on Cisco network infrastructure devices (such as routers and switches), where it captures network traffic directly from the device. This aligns with Salt Typhoon‚Äôs focus on telecommunications and ISP environments, where Cisco equipment is widely deployed and highly trusted.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 8 - The malware can perform 'Indicator Removal' by erasing logs. What is the MITRE ATT&CK ID for this?

T1070.002 ‚Äî Indicator Removal on Host: Clear Linux or Mac System Logs
This covers malware behavior that clears system logs (e.g., .bash_history, auth.log, wtmp/btmp) to remove evidence of compromise.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 9 - On December 20th, 2024, Picus Security released a blog on Salt Typhoon detailing some of the CVEs associated with the threat actor. What was the CVE for the vulnerability related to the Sophos Firewall?

According to the Picus Security blog published on December 20th, 2024, the vulnerability related to the Sophos Firewall associated with Salt Typhoon is:
    CVE-2022-3236
This CVE is a remote code execution (RCE) vulnerability in Sophos Firewall that has been exploited by threat actors to gain unauthorized access, making it relevant to Salt Typhoon‚Äôs operations.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 10 - The blog demonstrates how the group modifies the registry to obtain persistence with a backdoor known as Crowdoor. Which registry key do they target?
For Task 10, the blog explains that Salt Typhoon / GhostEmperor establishes persistence for the Crowdoor backdoor by abusing a common Windows auto-start location.

‚úÖ Registry key targeted for persistence
    HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run

üîç Why this key matters
  - Any value added under this Run key is executed automatically at system startup
  - It allows the backdoor to survive reboots
  - This is a classic and reliable persistence mechanism used by many advanced threat actors

üß† MITRE ATT&CK mapping
  - Technique: Boot or Logon Autostart Execution
  - Sub-technique: Registry Run Keys / Startup Folder

ATT&CK ID: T1547.001
  - This fits perfectly with Crowdoor‚Äôs role as a long-term backdoor focused on stealth and persistence.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 11 - What is the MITRE ATT&CK ID of the previous technique?

T1112 covers any activity where an attacker creates, alters, or deletes Windows registry keys or values to change system behavior.
This is a supporting technique, meaning it often enables:
  - Persistence
  - Defense evasion
  - Privilege escalation
  - Configuration tampering

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 12 - On November 25th, 2024, TrendMicro published a blog post detailing the threat actor. What name does this blog primarily use to refer to the group?

    Earth Estries

In its November 25th, 2024 blog post, Trend Micro primarily refers to the threat actor as Earth Estries.

Why the different name?
    - Security vendors often track the same threat actor under different names
    - Trend Micro uses the ‚ÄúEarth‚Äù naming convention for China-nexus activity clusters
    - Earth Estries = Salt Typhoon = GhostEmperor (same underlying actor, different vendor labels)
    - This is very common in threat intelligence and part of why MITRE ATT&CK mappings are so useful‚Äîthey help unify naming across vendors.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 13 - The blog post identifies additional malware attributed to the threat actor. Which malware do they describe as a 'multi-modular backdoor...using a custom protocol protected by Transport Layer Security'

The malware described in the Trend Micro (Nov 25, 2024) blog as a ‚Äúmulti-modular backdoor ‚Ä¶ using a custom protocol protected by Transport Layer Security (TLS)‚Äù is:

    GhostSpider

Trend Micro attributes GhostSpider to the same activity cluster it calls Earth Estries (also known as Salt Typhoon), highlighting its modular design and encrypted custom C2 communications over TLS.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 14 - Most of the domains the malware communicates with have a .com top-level domain. One uses a .dev TLD. What is the full domain name for the .dev TLD?

The full domain name using the .dev top-level domain is:

    telcom.grishamarkovgf8936.workers.dev

This domain stands out because most of the malware‚Äôs C2 infrastructure uses .com domains, while this one leverages Cloudflare Workers (workers.dev), likely to blend in with legitimate developer traffic and evade detection.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 15  - What is the filename for the first GET request to the C&C server used by the malware?

index.php

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 16 - On September 30th, 2021, a blog post was released on Securelist by Kaspersky. What was the threat actor's name at that time?
On September 30th, 2021, the Kaspersky Securelist blog referred to the threat actor as:

GhostEmperor

At that time, Kaspersky tracked the activity under the name GhostEmperor, which was later correlated by the wider security community with the group now known as Salt Typhoon (and Earth Estries in Trend Micro reporting).
This kind of multiple-name attribution across vendors is very common in threat intelligence and is exactly why MITRE ATT&CK mappings are so useful for tying everything together.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 17 - What is the name of the malware that this article focuses on?
The Kaspersky Securelist article (September 30th, 2021) focuses on the malware named:

Demodex

Demodex is a kernel-mode rootkit/backdoor, and it was the centerpiece of Kaspersky‚Äôs analysis of the threat actor they tracked at the time as GhostEmperor.


------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 18 - What type of malware is the above malware?
The malware Demodex is a:

Kernel-mode rootkit

Explanation:
    - Demodex operates at the kernel level, giving it very high privileges
    - It can hide processes, files, services, and network activity
    - It uses IOCTL codes to manipulate system internals and evade detection
    - This makes it well-suited for stealthy, long-term espionage, especially on critical infrastructure systems
Because of these capabilities, Demodex is classified as a kernel-mode rootkit/backdoor, which is one of the most stealthy and dangerous types of malware.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 19 - The first stage consists of a malicious PowerShell dropper. What type of encryption is used to obfuscate the code?
The malicious PowerShell dropper uses:

AES (Advanced Encryption Standard) encryption

Explanation:
    - The PowerShell script is AES-encrypted to obfuscate its contents
    - It is decrypted at runtime before executing the next stage
    - This helps evade static analysis and signature-based detection
AES is commonly used in advanced malware because it‚Äôs strong, fast, and widely supported, making it ideal for hiding payloads in scripts like PowerShell droppers.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Task 20 - The malware uses Input/Output Control codes to perform various tasks related to hiding malicious artifacts. What is the IOCTL code used by the malware to hide its service from the list within the services.exe process address space?
The malware uses Input/Output Control codes to perform various tasks related to hiding malicious artifacts. What is the IOCTL code used by the malware to hide its service from the list within the services.exe process address space?
The IOCTL code used by the malware (Demodex) to hide its service from the list within the services.exe process address space is:

0x220300

Context:
In the Kaspersky Securelist (30 Sept 2021) analysis, Demodex (a kernel-mode rootkit) uses specific IOCTL handlers to manipulate system structures and conceal its presence.
The IOCTL 0x220300 is explicitly associated with removing/hiding the malicious service from service enumeration, preventing it from appearing in standard service listings.



